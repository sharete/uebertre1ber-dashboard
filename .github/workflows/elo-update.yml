name: FACEIT ELO Auto Update

on:
  schedule:
  - cron: "*/30 * * * *" # alle 30 Minuten automatisch
  workflow_dispatch:


jobs:
  update:
    runs-on: ubuntu-latest

    steps:
    - name: üì• Repo auschecken
      uses: actions/checkout@v3

    - name: üõ†Ô∏è jq installieren
      run: sudo apt-get update && sudo apt-get install -y jq

    - name: üü¢ Ausf√ºhrrechte setzen
      run: chmod +x ./get_elos_from_ids.sh

    - name: üìÑ Spielerlisten wiederherstellen
      run: echo "$PLAYER_IDS" > players.txt
      env:
        PLAYER_IDS: ${{ secrets.PLAYER_IDS }}

    - name: Inhalt von players.txt anzeigen (Debug)
      run: |
        echo "Inhalt von players.txt:"
        cat players.txt

    - name: üß† FACEIT Script ausf√ºhren
      env:
        FACEIT_API_KEY: ${{ secrets.FACEIT_API_KEY }}
      run: ./get_elos_from_ids.sh

    - name: üîÅ √Ñnderungen committen und pushen
      run: |
        git config user.name "faceit-bot"
        git config user.email "faceit-bot@localhost"
        git add index.html
        git commit -m "Auto-Update: $(date)" || echo "Keine √Ñnderungen"
        git push
