name: 游꿡 Manage Players

on:
  workflow_dispatch:
    inputs:
      action:
        description: "Aktion"
        required: true
        type: choice
        options:
          - add
          - remove
      nickname:
        description: "FACEIT Nickname des Spielers"
        required: true
        type: string

jobs:
  manage:
    runs-on: ubuntu-latest

    steps:
    - name: 游닌 Repo auschecken
      uses: actions/checkout@v3

    - name: 游릭 Node.js einrichten
      uses: actions/setup-node@v3
      with:
        node-version: "20"

    - name: 游닍 Abh칛ngigkeiten installieren
      run: npm install

    - name: 游꿡 Spieler ${{ inputs.action }}
      env:
        FACEIT_API_KEY: ${{ secrets.FACEIT_API_KEY }}
      run: node manage-players.js ${{ inputs.action }} "${{ inputs.nickname }}"

    - name: 游대 츿nderungen committen und pushen
      run: |
        git config user.name "faceit-bot"
        git config user.email "faceit-bot@localhost"
        git add players.txt
        git commit -m "游꿡 Spieler ${{ inputs.action }}: ${{ inputs.nickname }}" || echo "游리 Keine 츿nderungen"
        git push

    - name: 游댃 Dashboard-Update triggern
      if: success()
      env:
        GH_TOKEN: ${{ github.token }}
      run: |
        gh workflow run "FACEIT ELO Auto Update" || echo "丘멆잺 Trigger fehlgeschlagen"
